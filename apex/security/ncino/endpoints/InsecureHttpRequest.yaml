rules:
  - id: apex.endpoints.insecure-http-request
    severity: ERROR
    languages:
      - apex
    metadata:
      cwe:
      - CWE-319 Cleartext Transmission of Sensitive Information https://cwe.mitre.org/data/definitions/319.html
      category: security
      subcategory: encryption
      technology: salesforce
    message: >-
      The software transmits sensitive or security-critical data in cleartext in
      a communication channel that can be sniffed by unauthorized actors.
    patterns:
      - pattern-regex: http[:][/][/]
      - pattern-not-regex: //.*
      - pattern-not-regex: '[*].*'
    paths:
      exclude:
        - "*Test*"
        - "*test*"
